!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TimeCircuits=t():e.TimeCircuits=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(e,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(3).polyfill();var c=("undefined"==typeof window?e:window,t.milliToNano=function(e){return 1e6*e}),a=(t.nanoToMilli=function(e){return e/1e6},t.TimeCircuits=function(){function e(t){i(this,e),this.options=o({},t),this.node=this.getTimeMode(),this.startingTime=null,this.handlers=[],this.margin=.0024}return u(e,[{key:"getTimeMode",value:function(){if(this.node=!1,"undefined"==typeof performance){if("undefined"==typeof r){var e=this.node?"environment":"browser";throw new Error("time-circuits: "+e+" not supported!")}this.node=!0}return this.node}},{key:"start",value:function(){return this.startingTime=this.getTime(),this.timeLoop(),this}},{key:"reset",value:function(){return this.startingTime=this.getTime(),this}},{key:"set",value:function(e,t,n){return this.handlers.push({time:c(t),func:e,id:n}),this}},{key:"unset",value:function(e){return this.handlers=this.handlers.filter(function(t){var n=t.id;return n===e}),this}},{key:"timeLoop",value:function(){var e=this,t=this.getTimeSinceStart();this.handlers=this.handlers.map(function(n){var r=n.time*(1-e.margin),i=n.time*(1+e.margin),o=t>=r&&t<=i,u=i<=t;return o?(n.func(),null):u?(e.options.ignoreMissed||n.func(),null):n}).filter(function(e){return e}),requestAnimationFrame(this.timeLoop.bind(this))}},{key:"getTime",value:function(){if(this.node){var e=r.hrtime(),t=1e9*e[0];return t+=e[1]}return performance.now()}},{key:"getTimeSinceStart",value:function(){return this.getTime()-this.startingTime}}]),e}()),s=new a;s.start(),t.default=s}).call(t,function(){return this}(),n(1))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function o(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function u(){p&&m&&(p=!1,m.length?d=m.concat(d):v=-1,d.length&&c())}function c(){if(!p){var e=i(u);p=!0;for(var t=d.length;t;){for(m=d,d=[];++v<t;)m&&m[v].run();v=-1,t=d.length}m=null,p=!1,o(e)}}function a(e,t){this.fun=e,this.array=t}function s(){}var f,l,h=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var m,d=[],p=!1,v=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new a(e,t)),1!==d.length||p||i(c)},a.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=s,h.addListener=s,h.once=s,h.off=s,h.removeListener=s,h.removeAllListeners=s,h.emit=s,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,n){(function(t){(function(){var n,r,i;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!=typeof t&&null!==t&&t.hrtime?(e.exports=function(){return(n()-i)/1e6},r=t.hrtime,n=function(){var e;return e=r(),1e9*e[0]+e[1]},i=n()):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(t,n(1))},function(e,t,n){(function(t){for(var r=n(2),i="undefined"==typeof window?t:window,o=["moz","webkit"],u="AnimationFrame",c=i["request"+u],a=i["cancel"+u]||i["cancelRequest"+u],s=0;!c&&s<o.length;s++)c=i[o[s]+"Request"+u],a=i[o[s]+"Cancel"+u]||i[o[s]+"CancelRequest"+u];if(!c||!a){var f=0,l=0,h=[],m=1e3/60;c=function(e){if(0===h.length){var t=r(),n=Math.max(0,m-(t-f));f=n+t,setTimeout(function(){var e=h.slice(0);h.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(f)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return h.push({handle:++l,callback:e,cancelled:!1}),l},a=function(e){for(var t=0;t<h.length;t++)h[t].handle===e&&(h[t].cancelled=!0)}}e.exports=function(e){return c.call(i,e)},e.exports.cancel=function(){a.apply(i,arguments)},e.exports.polyfill=function(){i.requestAnimationFrame=c,i.cancelAnimationFrame=a}}).call(t,function(){return this}())}])});